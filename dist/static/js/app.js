webpackJsonp([2,0],{0:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var a=n(127),s=i(a),r=n(126),o=i(r),u=n(118),l=i(u),c=n(44),d=i(c),f=n(45),h=i(f),v=new o.default({routes:[{path:"/search",component:d.default},{path:"/search-result",component:h.default},{path:"/",component:d.default}]});s.default.use(o.default),s.default.prototype.$routz=v,new s.default({el:"#app",router:v,template:"<App/>",components:{App:l.default}})},17:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=e.find(function(e){return t.Name===e.Name});n?(n.count++,n.date.push(+new Date)):(t.count=1,t.date=[+new Date],e.push(t))}function s(e,t){a(L.from,e),a(L.to,t)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(70),o=i(r),u=n(72),l=i(u),c=n(69),d=i(c),f=n(73),h=i(f),v=n(46),p=i(v),m="0.2",_=localStorage.getItem("localStorageVersion");m!==_&&(localStorage.clear(),localStorage.setItem("localStorageVersion",m));var g=[],y="quickresult",L=JSON.parse(localStorage.getItem(y));L||(L={from:[],to:[]});var C=function(e,t){if("Address"===t.Type){var n,i=e+"CoordLat",a=e+"CoordLong",s=e+"CoordName";return n={},(0,h.default)(n,i,t.Y/1e6),(0,h.default)(n,a,t.X/1e6),(0,h.default)(n,s,t.Name),n}var r=e+"Id";return(0,h.default)({},r,t.SiteId||t.Name)},b={fetch:function(e,t){return s(e,t),localStorage.setItem(y,(0,d.default)(L)),new l.default(function(n,i){var a={};(0,o.default)(a,C("origin",e)),(0,o.default)(a,C("dest",t)),p.default.post("api/search",a).then(function(e){g=e.data,n(g.map(function(e){return(0,o.default)(e,{detailed:!1})}))})})},typeahead:function(e){return new l.default(function(t,n){p.default.post("api/typeahead",{searchstring:e}).then(function(e){t(e.data)})})},getResult:function(){return g},quickResult:function(){return L}};t.default=b},44:function(e,t,n){n(115);var i=n(10)(n(66),n(124),"data-v-7ec8f895",null);e.exports=i.exports},45:function(e,t,n){n(112);var i=n(10)(n(68),n(121),"data-v-11d5752e",null);e.exports=i.exports},64:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),s=i(a),r=n(45),o=i(r);t.default={name:"app",components:{SearchForm:s.default,SearchResult:o.default}}},65:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"quick-result",props:["list"],computed:{filteredList:function(){return this.list.sort(function(e,t){return e.count<t.count}).slice(0,3)}},methods:{click:function(e){this.$emit("select",e)}}}},66:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),s=i(a),r=n(120),o=i(r);t.default={name:"searchForm",components:{"search-input":o.default},data:function(){return{quickResult:s.default.quickResult(),model:{from:void 0,to:void 0},searching:!1,error:""}},computed:{searchEnabled:function(){return this.model.from&&this.model.from.Name&&this.model.to&&this.model.to.Name}},methods:{search:function(){var e=this;this.model.from.Name&&this.model.to.Name&&(this.searching=!0,s.default.fetch(this.model.from,this.model.to).then(function(){e.searching=!1,e.$routz.replace("/search-result")},function(t){e.error=t}))},changeModel:function(e,t){this.model[e]=t}}}},67:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),s=i(a),r=n(119),o=i(r);t.default={name:"search-input",components:{"quick-result":o.default},props:["placeholder","quickResult"],data:function(){return{typeaheadList:[],active:void 0,searching:!1,model:{Name:""}}},watch:{model:{handler:function(e){this.$emit("modelChange",this.model)},deep:!0}},methods:{changed:function(){var e=this;this.model.Name.length>2&&(this.searching=!0,s.default.typeahead(this.model.Name).then(function(t){e.typeaheadList=t,e.active=e.typeaheadList[0],e.searching=!1},function(t){e.searching=!1,e.error=t}))},reset:function(){this.typeaheadList.splice(0,this.typeaheadList.length)},setModel:function(e){this.model=e},selectTypeahead:function(){this.setModel(this.active),this.reset()},setActive:function(e,t){if(this.active=t||this.active||this.typeaheadList[0],e){var n=this.typeaheadList.indexOf(this.active);this.active=this.typeaheadList[n+e]}}}}},68:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),s=i(a);t.default={name:"searchResult",data:function(){return{result:s.default.getResult(),getRealLegs:function(e){return e.LegList.Leg.filter(function(e){return"WALK"!==e.type})}}},filters:{origin:function(e){return e.LegList.Leg[0].Origin.name},destination:function(e){return e.LegList.Leg[e.LegList.Leg.length-1].Destination.name},time:function(e){return e.Leg[0].Origin.time+" ⇒ "+e.Leg[e.Leg.length-1].Destination.time},typeImg:function(e){return"static/"+e+"-icon.svg"}},created:function(){0===this.result.length&&this.$routz.push("search")}}},112:function(e,t){},113:function(e,t){},114:function(e,t){},115:function(e,t){},116:function(e,t){},118:function(e,t,n){n(114);var i=n(10)(n(64),n(123),null,null);e.exports=i.exports},119:function(e,t,n){n(116);var i=n(10)(n(65),n(125),null,null);e.exports=i.exports},120:function(e,t,n){n(113);var i=n(10)(n(67),n(122),null,null);e.exports=i.exports},121:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"result"},e._l(e.result,function(t){return n("li",{staticClass:"result-item",on:{click:function(e){t.detailed=!t.detailed}}},[n("div",{staticClass:"preview"},[n("div",{staticClass:"preview-head"},[n("h3",[e._v("\n          "+e._s(e._f("time")(t.LegList))+"\n        ")]),e._v(" "),n("div",{staticClass:"preview-legs"},e._l(e.getRealLegs(t),function(t){return n("div",{staticClass:"preview-leg"},[n("img",{staticClass:"preview-leg-img",attrs:{src:e._f("typeImg")(t.type)}}),e._v(" "),n("span",{staticClass:"preview-leg-text"},[e._v(e._s(t.line))])])})),e._v(" "),n("button",{staticClass:"expander"},[e._v("+")])]),e._v(" "),n("div",{staticClass:"preview-sub"},[n("h4",[e._v("\n          "+e._s(t.dur)+" min\n        ")]),e._v(" "),n("h5",[n("div",{staticClass:"no-break"},[e._v(e._s(e._f("origin")(t)))]),e._v(" "),n("div",{staticClass:"no-break"},[e._v(e._s(e._f("destination")(t)))])])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.detailed,expression:"res.detailed"}],staticClass:"body"},[e._l(e.getRealLegs(t),function(i){return[n("div",{staticClass:"body-leg",attrs:{alt:i.name}},[n("div",{staticClass:"body-leg__first-col"},[n("div",{staticClass:"body-leg__icon"},[n("img",{staticClass:"body-leg__icon-img",attrs:{src:e._f("typeImg")(i.type)}}),e._v(" "),n("span",{staticClass:"body-leg__icon-text"},[e._v(e._s(i.line))])]),e._v(" "),n("div",[n("p",{staticClass:"time"},[e._v(e._s(i.Origin.time))]),e._v(" "),n("p",{staticClass:"time"},[e._v(e._s(i.Destination.time))])])]),e._v(" "),n("table",{staticClass:"body-leg__extras"},[n("tr",[n("td",[e._v("Mot:")]),e._v(" "),n("td",[n("h5",[e._v(e._s(i.dir))])])]),e._v(" "),i!==t.LegList.Leg[t.LegList.Leg.length-1]?n("tr",[n("td",[e._v("Byt vid:")]),e._v(" "),n("td",[n("h5",[e._v(e._s(i.Destination.name))])])]):e._e()])])]})],2)])}))},staticRenderFns:[]}},122:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field-wrapper"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.model.Name,expression:"model.Name"}],attrs:{type:"text",placeholder:e.placeholder},domProps:{value:e.model.Name},on:{input:[function(t){t.target.composing||(e.model.Name=t.target.value)},function(t){e.changed()}],keydown:[function(t){return"button"in t||!e._k(t.keyCode,"esc",27)?void e.reset():null},function(t){return"button"in t||!e._k(t.keyCode,"down",40)?void e.setActive(1):null},function(t){return"button"in t||!e._k(t.keyCode,"enter",13)?(t.preventDefault(),void e.selectTypeahead()):null},function(t){return"button"in t||!e._k(t.keyCode,"up",38)?void e.setActive(-1):null}],blur:function(t){e.reset()}}}),e._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.typeaheadList.length||e.searching,expression:"typeaheadList.length || searching"}],staticClass:"typeahead-result"},[e.searching?n("li",[e._v("Söker")]):e._e(),e._v(" "),e._l(e.typeaheadList,function(t){return n("li",{staticClass:"typeahead-result-item",class:{"typeahead-result-item--active":t===e.active},on:{mousedown:function(n){e.selectTypeahead(t)},mouseover:function(n){e.setActive(0,t)}}},[e._v("\n      "+e._s(t.Name)+"\n    ")])})],2),e._v(" "),n("quick-result",{attrs:{list:e.quickResult},on:{select:e.setModel}})],1)},staticRenderFns:[]}},123:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("header",[n("h1",[n("router-link",{attrs:{to:"/"}},[e._v("\n        SLapp\n      ")])],1)]),e._v(" "),n("router-view")],1)},staticRenderFns:[]}},124:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("form",{on:{submit:function(t){t.preventDefault(),e.search()}}},[n("search-input",{attrs:{placeholder:"Från",quickResult:e.quickResult.from},on:{modelChange:function(t){e.changeModel("from",t)}}}),e._v(" "),n("search-input",{attrs:{placeholder:"Till",quickResult:e.quickResult.to},on:{modelChange:function(t){e.changeModel("to",t)}}}),e._v(" "),n("button",{staticClass:"btn btn-primary",attrs:{disabled:e.searching||!e.searchEnabled}},[e._v("Sök")]),e._v(" "),e.searching?n("p",[e._v("Söker")]):e._e(),e._v(" "),e.error?n("p",[e._v(e._s(e.error))]):e._e()],1)])},staticRenderFns:[]}},125:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"quick-wrapper"},e._l(e.filteredList,function(t){return n("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(n){e.click(t)}}},[e._v(e._s(t.Name))])}))},staticRenderFns:[]}}});
//# sourceMappingURL=app.js.map